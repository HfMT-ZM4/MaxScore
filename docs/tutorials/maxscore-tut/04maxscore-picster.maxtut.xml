<?xml version='1.0' encoding='UTF-8'?>

<?xml-stylesheet href="./_c74_tut.xsl" type="text/xsl"?>

<chapter name="Graphics in MaxScore">
<previous name="07maxscore-microtones">MaxScore: Preferences</previous>
<next name="08maxscore-playback">Playback</next>
<parent name="00maxscore-00index">MaxScore: Table of Contents</parent>


<h1>Graphics in MaxScore</h1>

<p>Picster is the mode in which the user can create and edit custom graphics</p>

<h2>Drawing modes</h2>
<p>First select a note / staff / measure for the graphics to be attached to.</p>
<p>Press Caps Lock to enable/disable Picster mode.</p>
<p>Select the drawing tools by pressing the following keys:</p>

<ul>
  <li>1: line segment</li>
  <li>2: rectangle</li>
  <li>3: rounded rectangle</li>
  <li>4: oval</li>
  <li>5: arc</li>
  <li>6: polygon</li>
  <li>7: freehand</li>
  <li>8: text</li>
  <li>9: image</li>
  <li>0: polycurve</li>
  <li>h: hairpin</li>
  <li>b: bracket</li>
</ul>

<p>The tool name will be displayed in red in the upper left corner of the canvas</p>

<p>For most tools, click and drag in order to create shapes. Note that notes(s) or staves need to be selected before the Picster mode is activated.</p>
<illustration><img src="images/Picster/picster-image1-small.png"/></illustration>
<i>Figure 1: The name of a Picster tool appears in the upper left-hand corner after pressing caps lock. Drawn shapes will be attached to the top staff in this particular case.</i>

<h3>6: polygon</h3>
<p>A polygon requires a number of clicks. It will only complete after ctrl-clicking the canvas which closes its path.</p>
<h3>8: text</h3>
<p>When the text tool is selected, a text box will pop up which can be written to. The text will appear in the score after clicking at the desired location.</p>
<h3>9: image</h3>
<p>Bitmap and vector images can be placed with the image tool. Clicking on the canvas will open a file dialog and the image will be placed at the clicked location.</p>
<h3>0: polycurve</h3>
<p>click or drag to create bezier curve nodes and handles. To delete the previous node, press shift once. To finish the shape, ctrl-click on the canvas. The end point will snap to the starting point if it's close enough (which creates a closed path).</p>

<illustration><img src="images/Picster/picster-image2-small.png"/></illustration>
<i>Figure 2: The name of a Picster tool appears in the upper left-hand corner after pressing caps lock. Drawn shapes will be attached to the top staff in this particular case.</i>

<illustration><img src="images/Picster/picster-image3-small.png"/></illustration>
<i>Figure 3: A text box opens when the text tool is selected.</i>

<h2>Setting properties</h2>
<p>Properties can be set by sending message to the canvas or bcanvas abstractions.</p>
<ul>
  <li>Color: send picster <i>color</i> and four numbers between 0 and 1 to set rgba values.</li>
  <li>Pensize: send <i>picster</i> pensize and one value to set line thickness</li>
  <li>Arc: send picster <i>arc</i> and two values to set start and end of the arc. Values are given in radians.</li>
  <li>Roundedness: send <i>picster</i> roundedness and one values to set the roundedness of a rounded rectangle</li>
  <li>Font and font size: send <i>picster</i> font and <i>picster</i> fontsize to set the appearance of text</li>
  <li>Property: sending picster <i>property</i> will determine whether a shape will be filled or not. Possible values are stroke or <i>fill</i>.</li>
  
</ul>

<illustration><img src="images/Picster/picster-image4-small.png"/></illustration>
<i>Figure 4: Color and other properties can be set by sending messages to the canvas before a shape is created</i>


<h2>Creating Shapes via Messages</h2>
<p>Picster on Board also receives messages for the creation of shapes via the second inlet of the mascore.bcanvas abstraction. These messages have the same result as drawing the shapes by hand, i.e. select the elements the shapes are supposed to be attached to first and set properties before the shapes are created.</p>
<p>The following messages can be used:</p>

<ul>
  <li>picster addShape offset1 offset2 line x1 x2 y1 y2</li>
  <li>picster addShape offset1 offset2 rectangle x1 x2 y1 y2</li>
  <li>picster addShape offset1 offset2 rounded_rectangle x1 x2 y1 y2</li>
  <li>picster addShape offset1 offset2 oval x1 x2 y1 y2</li>
  <li>picster addShape offset1 offset2 arc x1 x2 y1 y2</li>
  <li>picster addShape offset1 offset2 polygon x1 x2 y1 y2 ... xn yn</li>
  <li>picster addShape offset1 offset2 polyline x1 x2 y1 y2 ... xn yn</li>
  <li>picster addShape offset1 offset2 text “what’s up”</li>
  <li>picster addShape offset1 offset2 image "path_to_image/image.png"*</li>
  
</ul>

<p>The offset are applied in terms of absolute coordinates i.e. relative to the canvas’s origin. If you want to attach a shape relative to the coordinates of a score element, replace offset1 and offset2 each by periods, such as in</p>

<ul>
  <li>picster addShape . . line x1 x2 y1 y2</li>
  
</ul>
<p><i>*supported image types are png, tiff, jpeg and svg</i></p>

<h2>Selecting, moving and deleting shapes</h2>

<p>When a shaped is clicked on, a red bounding rectangle will appear and the shape can be moved by dragging the rectangle to another location. Should shapes overlap, the “covered” shapes can be selected by repeatedly ctrl-clicking on them. The bounding rectangle will change its shape accordingly. Selected shapes can be deleted with the delete key.</p>

<illustration><img src="images/Picster/picster-image5-small.png"/></illustration>
<i>Figure 5. Clicking on an object will selected it. It can now be moved, deleted or edited.</i>

<illustration><img src="images/Picster/picster-image6-small.png"/></illustration>
<p></p>
<illustration><img src="images/Picster/picster-image7-small.png"/></illustration>
<i>Figure 6 and 7: Select overlapping shapes by ctrl-clicking on the canvas</i>


<h2>Copy, cut and paste</h2>
<p>A shape can be copied, cut and pasted and thus attached to a different score element. Use the c, x and v keys in Picster mode, but be aware of the fact that in order to select another score element, Picster mode needs to be first toggled off. Once the element is selected, Picster mode should to be activated again.</p>

<h2>Adding shapes to staves or measures</h2>
<p>MaxScore allows you to also attach shapes to measures in addition to staves. This means that a shape will be shown automatically on every part should the score be split or rendered to multiple clients. It’s best used for global instructions that affect every members of an ensemble at once, such as tempo or overall dynamics.</p>
<p>Set the preference, by either pressing s for staff or m for measure, or by sending the following messages to the second inlet of bcanvas:</p>

<ul>
  <li>picster preference staff</li>
  <li>picster preference measure</li>
  
</ul>

<h2>Editing</h2>
<p>Once a shape is selected it can also be edited after pressing the e (“edit”) key. This will open a text editor showing the properties of the shape in JSON format. The changes can be finalized by pressing the u (“update”) key. Note that if the fill property is supposed to be changed from fill to stroke or vice versa, the id (2nd line) of the shape will also need to be changed in order to take effect, i.e. a paintrect will have to be renamed to framerect, a paintoval to frameoval and so on.</p>

<illustration><img src="images/Picster/picster-image8-small.png"/></illustration>
<i>Figure 8: Changes in the editor will take effect after closing the window and pressing the u key.</i>

<illustration><img src="images/Picster/picster-image9-small.png"/></illustration>
<i>Figure 9: Changing the "transform" property for example to [ 0.5, 0, 0, 0.5, 0, 0 ] will shrink the image to half its size.</i>

<h2>Adding Expressions</h2>
<p>You can add an expression to a shape if you want the expression to be sent when you either click on a shape (all types), or click on the note/interval the shape is attached to. Note and interval will also play their expressions during playback.</p>
<p>An expression is a sub dictionary which contains four keys:</p>

<ul class="dashed">
  <li>editor: currently inactive</li>
  <li>message: the message to be sent, e.g. sfplay</li>
  <li>value: value of the message, e.g. snare.mp3</li>
  <li>autorender : currently inactive</li>
  
</ul>

<p>To add an expression to a shape, select it first and send a message composed of the following items:</p>


<ul>
  <li>picster addExpressionToSelectedShape dictionary dictionary-name</li>  
</ul>

<p>dictionary-name being the name of the dictionary containing the four keys. The message also goes into the left-most inlet of bcanvas.</p>

<illustration><img src="images/Picster/picster-image10-small.png"/></illustration>
<p></p>
<i>Figure 10: Example for how to create a dictionary of an expression to be added to a Picster shape.</i>



</chapter>
