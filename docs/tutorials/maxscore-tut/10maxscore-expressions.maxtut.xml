<?xml version='1.0' encoding='UTF-8'?>

<?xml-stylesheet href="./_c74_tut.xsl" type="text/xsl"?>

<chapter name="MaxScore: Expressions">
<previous name="04maxscore-picster">MaxScore: Microtones</previous>
<next name="06maxscore-macaque">Macaque</next>

<parent name="00maxscore-00index">MaxScore: Expressions</parent>
<setdocpatch name="MaxScore-Expressions" patch="MaxScore-Expressions-Tutorial.maxpat"/>


<h1>MaxScore: Expressions</h1>

<p>MaxScore Expressions can be attached to any graphical element, and is written in DrawSocket JSON format as in the example below:</p>
<code>
{ 
    "key" : "expression",
    "val" : [
        {
            "editor": "default",
            "message": "one",
            "value": "two three"
        }
    ]
}
</code>
<p>MaxScore expressions are added optionally onto any <link name="04maxscore-picst4er.maxtut.xml">MaxScore graphical (picster) element.</link></p>
<p>The expression will be triggered whenever:</p>
<ul>
    <li>the note on which the graphical element attached is triggered,</li>
    <li>the graphical element is selected, or</li>
    <li>the graphical element is pressed when <i>Button Mode</i> is on.</li>
</ul>
<p>When the expression is triggered, it will be sent out of the first outlet of the <o>MaxScore</o> abstraction. The message should then be parsed through <o>maxscore.makenote</o> where </p>
<p>Please refer to the <link name="04maxscore-picst4er.maxtut.xml">MaxScore: Graphics</link> chapter for more information.</p>

<h2>Expression editors</h2>
<p>MaxScore Expressions can be added without knowing any coding. In the <link name="03maxscore-Sidebar.maxtut.xml">MaxScore Editor sidebar</link>, you will find the <i>Picster tab</i> in which you will find <i>Expressions</i>.</p>
<illustration><img src="images/Basics/Picster.png" width="600" /></illustration>
<p>Here you will find several ready-made templates for different expression usages:</p>

<h3>default</h3>
<techdetail>
    The default expression editor is one that consists of a pair of customizable <m>"message"</m> and <m>"value"</m>.
</techdetail>

<h3>bpf</h3>
<techdetail></techdetail>

<h2>Adding Custom Expressions</h2>
<p>In the canvas, turn on <b>Caps Lock</b> and select a graphical element. Press <b>E</b> and a dictionary editor will pop up, where you can add your own expressions.</p>
<p>In this example, the expression from the top of this chapter is attached onto a rectangle with id <m>"example_rect"</m>:</p>
<code>
    {
        "picster-element" : [
            {
                "key" : "svg",
                "val" : {
                    "new" : "rect",
                    "id" : "example_rect",
                    "x" : 0,
                    "y" : 0,
                    "width" : 50,
                    "height" : 50,
                    "style" : {
                        "stroke" : "rgb(0,0,0)",
                        "stroke-opacity" : 1,
                        "stroke-width" : [ 1 ],
                        "fill" : "none",
                        "fill-opacity" : 1
                    },
                    "transform" : "matrix(1,0,0,1,0,0)"
                }
            },
            {
                "key" : "extras",
                "val" : {
                    "bounds" : [ 0, 0, 50, 50 ]
                }
            }, 
            {
                "key" : "expression",
                "val" : [
                    {
                        "editor": "default",
                        "message": "one",
                        "value": "two three"
                    }
                ]
            }
        ]
    }
</code>
<p>Look at the last object in the array <m>"picster-element"</m> which says <m>{ "key" : "expression" }</m>. Here's where the expression should go.</p>

</chapter>